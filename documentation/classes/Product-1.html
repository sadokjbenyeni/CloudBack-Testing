<!doctype html>
<html class="no-js" lang="">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <title>histodata documentation</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <link rel="icon" type="image/x-icon" href="../images/favicon.ico">
	      <link rel="stylesheet" href="../styles/style.css">
    </head>
    <body>

        <div class="navbar navbar-default navbar-fixed-top visible-xs">
            <a href="../" class="navbar-brand">histodata documentation</a>
            <button type="button" class="btn btn-default btn-menu ion-ios-menu" id="btn-menu"></button>
        </div>

        <div class="xs-menu menu" id="mobile-menu">
                <div id="book-search-input" role="search"><input type="text" placeholder="Type to search"></div>            <compodoc-menu></compodoc-menu>
        </div>

        <div class="container-fluid main">
           <div class="row main">
               <div class="hidden-xs menu">
                   <compodoc-menu mode="normal"></compodoc-menu>
               </div>
               <!-- START CONTENT -->
               <div class="content class">
                   <div class="content-data">











<ol class="breadcrumb">
  <li>Classes</li>
  <li>Product</li>
</ol>

<ul class="nav nav-tabs" role="tablist">
        <li class="active">
            <a href="#info" role="tab" id="info-tab" data-toggle="tab" data-link="info">Info</a>
        </li>
        <li >
            <a href="#source" role="tab" id="source-tab" data-toggle="tab" data-link="source">Source</a>
        </li>
</ul>

<div class="tab-content">
    <div class="tab-pane fade active in" id="c-info">
        <p class="comment">
            <h3>File</h3>
        </p>
        <p class="comment">
            <code>src/app/components/search/search.component.ts</code>
        </p>





            <section>
    <h3 id="index">Index</h3>
    <table class="table table-sm table-bordered index-table">
        <tbody>
                <tr>
                    <td class="col-md-4">
                        <h6><b>Properties</b></h6>
                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <ul class="index-list">
                            <li>
                                <a href="#adtv">adtv</a>
                            </li>
                            <li>
                                <a href="#assetClass">assetClass</a>
                            </li>
                            <li>
                                <a href="#begin_date">begin_date</a>
                            </li>
                            <li>
                                <a href="#begin_date_select">begin_date_select</a>
                            </li>
                            <li>
                                <a href="#constratid">constratid</a>
                            </li>
                            <li>
                                <a href="#contractid">contractid</a>
                            </li>
                            <li>
                                <a href="#description">description</a>
                            </li>
                            <li>
                                <a href="#eid">eid</a>
                            </li>
                            <li>
                                <a href="#end_date">end_date</a>
                            </li>
                            <li>
                                <a href="#end_date_select">end_date_select</a>
                            </li>
                            <li>
                                <a href="#exchange">exchange</a>
                            </li>
                            <li>
                                <a href="#historical_data">historical_data</a>
                            </li>
                            <li>
                                <a href="#id_cmd">id_cmd</a>
                            </li>
                            <li>
                                <a href="#idx">idx</a>
                            </li>
                            <li>
                                <a href="#index">index</a>
                            </li>
                            <li>
                                <a href="#mics">mics</a>
                            </li>
                            <li>
                                <a href="#onetime">onetime</a>
                            </li>
                            <li>
                                <a href="#price">price</a>
                            </li>
                            <li>
                                <a href="#pricingtier">pricingtier</a>
                            </li>
                            <li>
                                <a href="#qhid">qhid</a>
                            </li>
                            <li>
                                <a href="#quotation_level">quotation_level</a>
                            </li>
                            <li>
                                <a href="#status">status</a>
                            </li>
                            <li>
                                <a href="#subscription">subscription</a>
                            </li>
                            <li>
                                <a href="#symbol">symbol</a>
                            </li>
                        </ul>
                    </td>
                </tr>






        </tbody>
    </table>
</section>


            <section>
    
        <h3 id="inputs">
            Properties
        </h3>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="adtv"></a>
                        <span class="name">
                            <b>
                            adtv
                            </b>
                            <a href="#adtv"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <code>adtv:     <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
</code>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Type : </i>    <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>

                        </td>
                    </tr>
                        <tr>
                            <td class="col-md-4">
                                    <div class="io-line">Defined in <a href="" data-line="20" class="link-to-prism">src/app/components/search/search.component.ts:20</a></div>
                            </td>
                        </tr>


            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="assetClass"></a>
                        <span class="name">
                            <b>
                            assetClass
                            </b>
                            <a href="#assetClass"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <code>assetClass:     <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
</code>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Type : </i>    <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>

                        </td>
                    </tr>
                        <tr>
                            <td class="col-md-4">
                                    <div class="io-line">Defined in <a href="" data-line="30" class="link-to-prism">src/app/components/search/search.component.ts:30</a></div>
                            </td>
                        </tr>


            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="begin_date"></a>
                        <span class="name">
                            <b>
                            begin_date
                            </b>
                            <a href="#begin_date"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <code>begin_date:     <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
</code>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Type : </i>    <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>

                        </td>
                    </tr>
                        <tr>
                            <td class="col-md-4">
                                    <div class="io-line">Defined in <a href="" data-line="35" class="link-to-prism">src/app/components/search/search.component.ts:35</a></div>
                            </td>
                        </tr>


            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="begin_date_select"></a>
                        <span class="name">
                            <b>
                            begin_date_select
                            </b>
                            <a href="#begin_date_select"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <code>begin_date_select:     <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
</code>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Type : </i>    <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>

                        </td>
                    </tr>
                        <tr>
                            <td class="col-md-4">
                                    <div class="io-line">Defined in <a href="" data-line="36" class="link-to-prism">src/app/components/search/search.component.ts:36</a></div>
                            </td>
                        </tr>


            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="constratid"></a>
                        <span class="name">
                            <b>
                            constratid
                            </b>
                            <a href="#constratid"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <code>constratid:     <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
</code>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Type : </i>    <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>

                        </td>
                    </tr>
                        <tr>
                            <td class="col-md-4">
                                    <div class="io-line">Defined in <a href="" data-line="26" class="link-to-prism">src/app/components/search/search.component.ts:26</a></div>
                            </td>
                        </tr>


            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="contractid"></a>
                        <span class="name">
                            <b>
                            contractid
                            </b>
                            <a href="#contractid"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <code>contractid:     <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
</code>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Type : </i>    <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>

                        </td>
                    </tr>
                        <tr>
                            <td class="col-md-4">
                                    <div class="io-line">Defined in <a href="" data-line="31" class="link-to-prism">src/app/components/search/search.component.ts:31</a></div>
                            </td>
                        </tr>


            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="description"></a>
                        <span class="name">
                            <b>
                            description
                            </b>
                            <a href="#description"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <code>description:     <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
</code>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Type : </i>    <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>

                        </td>
                    </tr>
                        <tr>
                            <td class="col-md-4">
                                    <div class="io-line">Defined in <a href="" data-line="21" class="link-to-prism">src/app/components/search/search.component.ts:21</a></div>
                            </td>
                        </tr>


            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="eid"></a>
                        <span class="name">
                            <b>
                            eid
                            </b>
                            <a href="#eid"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <code>eid:     <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
</code>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Type : </i>    <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>

                        </td>
                    </tr>
                        <tr>
                            <td class="col-md-4">
                                    <div class="io-line">Defined in <a href="" data-line="27" class="link-to-prism">src/app/components/search/search.component.ts:27</a></div>
                            </td>
                        </tr>


            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="end_date"></a>
                        <span class="name">
                            <b>
                            end_date
                            </b>
                            <a href="#end_date"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <code>end_date:     <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
</code>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Type : </i>    <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>

                        </td>
                    </tr>
                        <tr>
                            <td class="col-md-4">
                                    <div class="io-line">Defined in <a href="" data-line="37" class="link-to-prism">src/app/components/search/search.component.ts:37</a></div>
                            </td>
                        </tr>


            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="end_date_select"></a>
                        <span class="name">
                            <b>
                            end_date_select
                            </b>
                            <a href="#end_date_select"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <code>end_date_select:     <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
</code>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Type : </i>    <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>

                        </td>
                    </tr>
                        <tr>
                            <td class="col-md-4">
                                    <div class="io-line">Defined in <a href="" data-line="38" class="link-to-prism">src/app/components/search/search.component.ts:38</a></div>
                            </td>
                        </tr>


            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="exchange"></a>
                        <span class="name">
                            <b>
                            exchange
                            </b>
                            <a href="#exchange"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <code>exchange:     <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
</code>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Type : </i>    <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>

                        </td>
                    </tr>
                        <tr>
                            <td class="col-md-4">
                                    <div class="io-line">Defined in <a href="" data-line="29" class="link-to-prism">src/app/components/search/search.component.ts:29</a></div>
                            </td>
                        </tr>


            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="historical_data"></a>
                        <span class="name">
                            <b>
                            historical_data
                            </b>
                            <a href="#historical_data"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <code>historical_data:     <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/object" target="_blank" >object</a></code>
</code>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Type : </i>    <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/object" target="_blank" >object</a></code>

                        </td>
                    </tr>
                        <tr>
                            <td class="col-md-4">
                                    <div class="io-line">Defined in <a href="" data-line="40" class="link-to-prism">src/app/components/search/search.component.ts:40</a></div>
                            </td>
                        </tr>


            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="id_cmd"></a>
                        <span class="name">
                            <b>
                            id_cmd
                            </b>
                            <a href="#id_cmd"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <code>id_cmd:     <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
</code>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Type : </i>    <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>

                        </td>
                    </tr>
                        <tr>
                            <td class="col-md-4">
                                    <div class="io-line">Defined in <a href="" data-line="39" class="link-to-prism">src/app/components/search/search.component.ts:39</a></div>
                            </td>
                        </tr>


            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="idx"></a>
                        <span class="name">
                            <b>
                            idx
                            </b>
                            <a href="#idx"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <code>idx:     <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
</code>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Type : </i>    <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>

                        </td>
                    </tr>
                        <tr>
                            <td class="col-md-4">
                                    <div class="io-line">Defined in <a href="" data-line="18" class="link-to-prism">src/app/components/search/search.component.ts:18</a></div>
                            </td>
                        </tr>


            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="index"></a>
                        <span class="name">
                            <b>
                            index
                            </b>
                            <a href="#index"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <code>index:     <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
</code>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Type : </i>    <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>

                        </td>
                    </tr>
                        <tr>
                            <td class="col-md-4">
                                    <div class="io-line">Defined in <a href="" data-line="19" class="link-to-prism">src/app/components/search/search.component.ts:19</a></div>
                            </td>
                        </tr>


            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="mics"></a>
                        <span class="name">
                            <b>
                            mics
                            </b>
                            <a href="#mics"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <code>mics:     <code>Array&lt;any&gt;</code>
</code>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Type : </i>    <code>Array&lt;any&gt;</code>

                        </td>
                    </tr>
                        <tr>
                            <td class="col-md-4">
                                    <div class="io-line">Defined in <a href="" data-line="32" class="link-to-prism">src/app/components/search/search.component.ts:32</a></div>
                            </td>
                        </tr>


            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="onetime"></a>
                        <span class="name">
                            <b>
                            onetime
                            </b>
                            <a href="#onetime"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <code>onetime:     <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/number" target="_blank" >number</a></code>
</code>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Type : </i>    <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/number" target="_blank" >number</a></code>

                        </td>
                    </tr>
                        <tr>
                            <td class="col-md-4">
                                    <div class="io-line">Defined in <a href="" data-line="24" class="link-to-prism">src/app/components/search/search.component.ts:24</a></div>
                            </td>
                        </tr>


            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="price"></a>
                        <span class="name">
                            <b>
                            price
                            </b>
                            <a href="#price"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <code>price:     <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/number" target="_blank" >number</a></code>
</code>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Type : </i>    <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/number" target="_blank" >number</a></code>

                        </td>
                    </tr>
                        <tr>
                            <td class="col-md-4">
                                    <div class="io-line">Defined in <a href="" data-line="23" class="link-to-prism">src/app/components/search/search.component.ts:23</a></div>
                            </td>
                        </tr>


            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="pricingtier"></a>
                        <span class="name">
                            <b>
                            pricingtier
                            </b>
                            <a href="#pricingtier"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <code>pricingtier:     <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/number" target="_blank" >number</a></code>
</code>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Type : </i>    <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/number" target="_blank" >number</a></code>

                        </td>
                    </tr>
                        <tr>
                            <td class="col-md-4">
                                    <div class="io-line">Defined in <a href="" data-line="22" class="link-to-prism">src/app/components/search/search.component.ts:22</a></div>
                            </td>
                        </tr>


            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="qhid"></a>
                        <span class="name">
                            <b>
                            qhid
                            </b>
                            <a href="#qhid"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <code>qhid:     <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
</code>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Type : </i>    <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>

                        </td>
                    </tr>
                        <tr>
                            <td class="col-md-4">
                                    <div class="io-line">Defined in <a href="" data-line="33" class="link-to-prism">src/app/components/search/search.component.ts:33</a></div>
                            </td>
                        </tr>


            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="quotation_level"></a>
                        <span class="name">
                            <b>
                            quotation_level
                            </b>
                            <a href="#quotation_level"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <code>quotation_level:     <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
</code>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Type : </i>    <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>

                        </td>
                    </tr>
                        <tr>
                            <td class="col-md-4">
                                    <div class="io-line">Defined in <a href="" data-line="34" class="link-to-prism">src/app/components/search/search.component.ts:34</a></div>
                            </td>
                        </tr>


            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="status"></a>
                        <span class="name">
                            <b>
                            status
                            </b>
                            <a href="#status"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <code>status:     <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
</code>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Type : </i>    <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>

                        </td>
                    </tr>
                        <tr>
                            <td class="col-md-4">
                                    <div class="io-line">Defined in <a href="" data-line="41" class="link-to-prism">src/app/components/search/search.component.ts:41</a></div>
                            </td>
                        </tr>


            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="subscription"></a>
                        <span class="name">
                            <b>
                            subscription
                            </b>
                            <a href="#subscription"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <code>subscription:     <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/number" target="_blank" >number</a></code>
</code>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Type : </i>    <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/number" target="_blank" >number</a></code>

                        </td>
                    </tr>
                        <tr>
                            <td class="col-md-4">
                                    <div class="io-line">Defined in <a href="" data-line="25" class="link-to-prism">src/app/components/search/search.component.ts:25</a></div>
                            </td>
                        </tr>


            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="symbol"></a>
                        <span class="name">
                            <b>
                            symbol
                            </b>
                            <a href="#symbol"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <code>symbol:     <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
</code>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Type : </i>    <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>

                        </td>
                    </tr>
                        <tr>
                            <td class="col-md-4">
                                    <div class="io-line">Defined in <a href="" data-line="28" class="link-to-prism">src/app/components/search/search.component.ts:28</a></div>
                            </td>
                        </tr>


            </tbody>
        </table>
</section>







    </div>


    <div class="tab-pane fade  tab-source-code" id="c-source">
        <pre class="line-numbers compodoc-sourcecode"><code class="language-typescript">import { Component, OnInit, AfterViewInit, ViewChild, ElementRef } from &#x27;@angular/core&#x27;;
import { Router, ActivatedRoute } from &#x27;@angular/router&#x27;;
import { HttpClient, HttpResponse } from &#x27;@angular/common/http&#x27;;
import { NgbTabChangeEvent, NgbDatepickerConfig, NgbModal, ModalDismissReasons, NgbDateStruct, NgbCalendar } from &#x27;@ng-bootstrap/ng-bootstrap&#x27;;

import { environment } from &#x27;../../../environments/environment&#x27;;
import { DataService } from &#x27;../../data.service&#x27;;
import { ElasticService } from &#x27;../../services/elastic.service&#x27;;
import { stagger } from &#x27;@angular/core/src/animation/dsl&#x27;;
import { toInteger } from &#x27;@ng-bootstrap/ng-bootstrap/util/util&#x27;;

import { OrderService } from &#x27;../../services/order.service&#x27;;
import { UserService } from &#x27;../../services/user.service&#x27;;
import { ConfigService } from &#x27;../../services/config.service&#x27;;
import { FluxService } from &#x27;../../services/flux.service&#x27;;

class Product {
  idx: string;
  index: string;
  adtv: string;
  description: string;
  pricingtier: number;
  price: number;
  onetime: number;
  subscription: number;
  constratid: string;
  eid: string;
  symbol: string;
  exchange: string;
  assetClass: string;
  contractid: string;
  mics: Array&lt;any&gt;;
  qhid: string;
  quotation_level: string;
  begin_date: string;
  begin_date_select: string;
  end_date: string;
  end_date_select: string;
  id_cmd: string;
  historical_data: object;
  status: string;
}

const equals &#x3D; (one: NgbDateStruct, two: NgbDateStruct) &#x3D;&gt;
  one &amp;&amp; two &amp;&amp; two.year &#x3D;&#x3D;&#x3D; one.year &amp;&amp; two.month &#x3D;&#x3D;&#x3D; one.month &amp;&amp; two.day &#x3D;&#x3D;&#x3D; one.day;

const before &#x3D; (one: NgbDateStruct, two: NgbDateStruct) &#x3D;&gt;
  !one || !two ? false : one.year &#x3D;&#x3D;&#x3D; two.year ? one.month &#x3D;&#x3D;&#x3D; two.month ? one.day &#x3D;&#x3D;&#x3D; two.day
    ? false : one.day &lt; two.day : one.month &lt; two.month : one.year &lt; two.year;

const after &#x3D; (one: NgbDateStruct, two: NgbDateStruct) &#x3D;&gt;
  !one || !two ? false : one.year &#x3D;&#x3D;&#x3D; two.year ? one.month &#x3D;&#x3D;&#x3D; two.month ? one.day &#x3D;&#x3D;&#x3D; two.day
    ? false : one.day &gt; two.day : one.month &gt; two.month : one.year &gt; two.year;

@Component({
  selector: &#x27;app-search&#x27;,
  templateUrl: &#x27;./search.component.html&#x27;,
  styleUrls: [&#x27;./search.component.css&#x27;]
})
export class SearchComponent implements OnInit, AfterViewInit {
  caddies: Array&lt;object&gt;;
  tabPrice: any;
  ds: string;
  exchangesRef: any;
  assetsRef: any;
  tabPricingTier: any;
  user: object;
  catalogue: object;
  formatfile: string;
  caddy: Array&lt;object&gt;;
  tabsearch: any;
  to: number;
  from: number;
  pageTo: number;
  total: number;
  btnSearch: boolean;
  onetimeTo: NgbDateStruct;
  onetimeFrom: NgbDateStruct;
  runsearch: boolean;
  dataset: any;
  datasets: Array&lt;object&gt;;
  pagesize: any;
  page: number;
  reqSearch: { fields: string[], query: { bool: { must: any[], should: any[], must_not: any[] } }, aggs: object, from: number, size: number, index: any[], type: any[] };
  nbperpage: string;
  nassc: string;
  exchange: string;
  period: { begin_date: string, end_date: string };
  periodSubscription: number;
  options: Array&lt;any&gt;;
  closeResult: string;
  search: string;
  assets: Array&lt;object&gt;;
  nbPerPage: Array&lt;object&gt;;
  exchanges: Array&lt;object&gt;;
  assetsSearch: Array&lt;object&gt;;
  exchangesSearch: Array&lt;object&gt;;
  out: object;
  hoveredDate: NgbDateStruct;
  fromDate: NgbDateStruct;
  calendar: NgbCalendar;
  toDate: NgbDateStruct;
  minDate: { year: number, month: number, day: number };
  maxDate: { year: number, month: number, day: number };
  // dtOptions: DataTables.Settings &#x3D; {};
  hits: Array&lt;any&gt;;
  avaibility: boolean;
  addCart: {
    onetime: number,
    complete: number,
    onetimeFrom: string,
    onetimeTo: string,
    subscription: number,
    products: Array&lt;Product&gt;
  };

  // fields search
  all: string;
  symbol: string;
  isin: string;
  mics: string;

  constructor(
    private http: HttpClient,
    private route: ActivatedRoute,
    private router: Router,
    private data: DataService,
    private elasticService: ElasticService,
    private userService: UserService,
    private fluxService: FluxService,
    private configService: ConfigService,
    private orderService: OrderService,
    private modalService: NgbModal,
    private calenda: NgbCalendar,
    private config: NgbDatepickerConfig
  ) {
    // this.inputEl;
    // customize default values of datepickers used by this component tree
    config.minDate &#x3D; { year: 2000, month: 1, day: 1 };
    config.maxDate &#x3D; { year: 2050, month: 12, day: 31 };

    // days that don&#x27;t belong to current month are not visible
    config.outsideDays &#x3D; &#x27;hidden&#x27;;

    this.avaibility &#x3D; false;
    this.calendar &#x3D; calenda;
    this.reset();
    this.options &#x3D; [];
    this.reqSearch.from &#x3D; 0;
    this.nbperpage &#x3D; &#x27;10&#x27;;
    this.btnSearch &#x3D; true;
    this.total &#x3D; 0;
    this.addCart &#x3D; {
      onetime: 0,
      complete: 0,
      onetimeFrom: &#x27;&#x27;,
      onetimeTo: &#x27;&#x27;,
      subscription: 0,
      products: []
    };
  }

  @ViewChild(&quot;runsearch&quot;)
  private inputEl: ElementRef;

  ngAfterViewInit(){
    this.inputEl.nativeElement.focus();
  }

  ngOnInit() {
    // this.inputEl;
    this.dataset &#x3D; JSON.parse(sessionStorage.getItem(&#x27;dataset&#x27;));
    if (!this.dataset || !this.dataset.hasOwnProperty(&#x27;dataset&#x27;)) {
      this.router.navigateByUrl(&#x27;/&#x27;);
    } else {
      this.getCatalogue();
    }
    this.search &#x3D; this.dataset.title;
    this.user &#x3D; JSON.parse(sessionStorage.getItem(&#x27;user&#x27;));
    this.getInfoUser(this.user[&#x27;token&#x27;]);
    this.getCaddy(this.user[&#x27;_id&#x27;]);
    this.exchanges &#x3D; [];
    this.assets &#x3D; [];
    this.tabsearch &#x3D; &#x27;instrument&#x27;;
    this.formatfile &#x3D; &#x27;csv&#x27;;
    this.getCaddie();
    this.getShowEntries();
    this.getPeriod();
    this.getPricingTier();
    this.getPrice();
    this.datasets &#x3D; [
      { id: &#x27;L1TRADEONLY&#x27;, name: &#x27;L1 - Trades&#x27;, search: &#x27;Find Times &amp; Sales&#x27; },
      { id: &#x27;L1&#x27;, name: &#x27;L1 - Full&#x27;, search: &#x27;Find Top of Book&#x27; },
      { id: &#x27;L2&#x27;, name: &#x27;L2&#x27;, search: &#x27;Find L2-MBL&#x27; }
    ];
    // this.data.currentSearch.subscribe(search &#x3D;&gt; this.search &#x3D; search);
  }
  resetSelect(){
    this.hits.forEach(hit&#x3D;&gt;{
      hit.selected &#x3D; false;
    });
    this.addCart &#x3D; {
      onetime: 0,
      complete: 0,
      onetimeFrom: &#x27;&#x27;,
      onetimeTo: &#x27;&#x27;,
      subscription: 0,
      products: []
    };
  }
  setDataset(e) {
    this.reset();
    let dtst &#x3D; this.searchDataset(e, this.datasets);
    sessionStorage.setItem(&#x27;dataset&#x27;, JSON.stringify({ dataset: dtst.id, title: dtst.name }));
    this.data.changeSearch(dtst.search);
    this.search &#x3D; dtst.search
    this.getCatalogue();
  }

  getCatalogue() {
    this.ds &#x3D; &#x27;&#x27;;
    if (this.dataset.dataset &#x3D;&#x3D;&#x3D; &#x27;L1TRADEONLY&#x27;) { this.ds &#x3D; &#x27;Trades&#x27;; }
    if (this.dataset.dataset &#x3D;&#x3D;&#x3D; &#x27;L1&#x27;) { this.ds &#x3D; &#x27;L1&#x27;; }
    if (this.dataset.dataset &#x3D;&#x3D;&#x3D; &#x27;L2&#x27;) { this.ds &#x3D; &#x27;MBL&#x27;; }
    this.fluxService.catalogue(this.ds).subscribe(res &#x3D;&gt; {
      this.catalogue &#x3D; res;
      this.getAssetExchange();
    });
  }

  rSearch() {
    this.btnSearch &#x3D; false;
    this.page &#x3D; 0;
    this.getSearch();
  }

  getPeriod() {
    this.configService.getPeriod().subscribe(res &#x3D;&gt; {
      this.periodSubscription &#x3D; res[0].value;
    });
  }

  verifPricingTier(index, adtv): number {
    let val &#x3D; 1;
    this.tabPricingTier.forEach(pt &#x3D;&gt; {
      if(index &#x3D;&#x3D;&#x3D; environment.elastic.instrument.derivatives) {
        if (pt.pricingTier &#x3D;&#x3D;&#x3D; 1 &amp;&amp; pt.sup &lt;&#x3D; adtv) {
          val &#x3D; 1;
        } else if (pt.pricingTier &#x3D;&#x3D;&#x3D; 2 &amp;&amp; pt.inf &gt; adtv) {
          val &#x3D; 2;
        }
      }
      if(index &#x3D;&#x3D;&#x3D; environment.elastic.instrument.nonderivatives) {
        if (pt.pricingTier &#x3D;&#x3D;&#x3D; 3 &amp;&amp; pt.sup &lt;&#x3D; adtv) {
          val &#x3D; 3;
        } else if (pt.pricingTier &#x3D;&#x3D;&#x3D; 4 &amp;&amp; pt.inf &gt; adtv) {
          val &#x3D; 4;
        }
      }
    });
    return val;
  }

  getInfoUser(token){
    let field &#x3D; [
      &#x27;id&#x27;,
      &#x27;token&#x27;,
    ];
    this.userService.info({token: token, field: field}).subscribe(res&#x3D;&gt;{
      this.user &#x3D; res.user;
    });
  }

  getCaddy(iduser){
    this.orderService.getCaddies({id: iduser}).subscribe((c) &#x3D;&gt; {
      this.caddies &#x3D; [];
      if(c.cmd.length &gt; 0 ) {
        c.cmd.forEach((cmd) &#x3D;&gt; {
          cmd.products.forEach((p) &#x3D;&gt; {
            let prod &#x3D; {
              id: p.idx,
              quotation_level: p.dataset,
              description: p.description,
              onetime: p.onetime,
              subscription: p.subscription,
              begin_date_select: p.begin_date,
              bdref: this.dateNGB(p.begin_date_ref),
              begin_date: p.begin_date_ref,
              bds: this.dateNGB(p.begin_date),
              end_date_select : p.end_date,
              end_date : p.end_date_ref,
              edref : this.dateNGB(p.end_date_ref),
              eds : this.dateNGB(p.end_date)
            };
            this.caddies.push(prod);
          });
        });
      }
    });
  }

  getCaddie(){
    this.orderService.getIdOrder(this.user[&#x27;_id&#x27;]).subscribe(p&#x3D;&gt;{
      this.caddy &#x3D; p;
    });
  }

  getPrice() {
    this.fluxService.pricingTier().subscribe(res &#x3D;&gt; {
      this.tabPrice &#x3D; res;
    });
  }

  getPricingTier() {
    if (this.tabsearch &#x3D;&#x3D;&#x3D; &#x27;instrument&#x27;) {
      this.configService.getPricingTier().subscribe(res &#x3D;&gt; {
        this.tabPricingTier &#x3D; res[0].tab;
      });
    }
  }

  getAssetExchange() {
    let q &#x3D; {};
    if (this.tabsearch &#x3D;&#x3D;&#x3D; &#x27;instrument&#x27;) {
      q[&#x27;index&#x27;] &#x3D; environment.elastic.instrument.index;
      q[&#x27;type&#x27;] &#x3D; environment.elastic.instrument.type;
    }
    if (this.tabsearch &#x3D;&#x3D;&#x3D; &#x27;feed&#x27;) {
      q[&#x27;index&#x27;] &#x3D; environment.elastic.feed.index;
      q[&#x27;type&#x27;] &#x3D; environment.elastic.feed.type;
    }
    q[&#x27;fields&#x27;] &#x3D; [];
    q[&#x27;query&#x27;] &#x3D; {
      &quot;bool&quot;: {
        &quot;should&quot;: [
          {
            &quot;terms&quot;: {
              &quot;EID&quot;: this.catalogue[&#x27;tabEid&#x27;]
            }
          },
          {
            &quot;terms&quot;: {
              &quot;ContractEID&quot;: this.catalogue[&#x27;tabEid&#x27;]
            }
          }
        ]
      }
    };
    q[&quot;aggs&quot;] &#x3D; {
      &quot;exchanges&quot;: {
        &quot;terms&quot;: {
          &quot;size&quot;: 1000,
          &quot;field&quot;: &quot;ExchangeName&quot;
        }
      },
      &quot;exchangesLong&quot;: {
        &quot;terms&quot;: {
          &quot;size&quot;: 1000,
          &quot;script&quot;: &quot;doc[&#x27;ExchangeName&#x27;].values + &#x27;§&#x27; + doc[&#x27;ExchangeLongName&#x27;].values&quot;
          // &quot;field&quot;: &quot;ExchangeLongName&quot;
        }
      },
      // &quot;exchange_agg&quot;: {
      //   &quot;terms&quot;: {
      //     &quot;field&quot;: &quot;ContractExchange&quot;
      //   }
      // },
      &quot;assets&quot;: {
        &quot;terms&quot;: {
          &quot;size&quot;: 1000,
          &quot;field&quot;: &quot;AssetClass&quot;
        }
      }//,
      // &quot;assets_agg&quot;: {
      //   &quot;terms&quot;: {
      //     &quot;field&quot;: &quot;ContractAssetClass&quot;
      //   }
      // }
    };
    q[&#x27;from&#x27;] &#x3D; 0;
    q[&#x27;size&#x27;] &#x3D; 1;
    this.elasticService.getSearch(q).subscribe(resp &#x3D;&gt; {
      this.getAsset(resp.aggregations.assets.buckets);
      this.getExchangesBis(resp.aggregations.exchanges.buckets, resp.aggregations.exchangesLong.buckets);
      // this.getExchanges(resp.aggregations.exchanges.buckets);
    });
  };

  getAsset(assets) {
    this.assets &#x3D; [];
    // this.fluxService.getAssets().subscribe(flux &#x3D;&gt; {
      // this.assetsRef &#x3D; flux;
      assets.forEach(a &#x3D;&gt; {
        // if (a.key !&#x3D;&#x3D; &#x27;&#x27; &amp;&amp; this.assetsRef.find(x &#x3D;&gt; x.id &#x3D;&#x3D;&#x3D; a.key)) {
          // this.assets.push({ id: a.key, name: this.assetsRef.find(x &#x3D;&gt; x.id &#x3D;&#x3D;&#x3D; a.key).name });
          this.assets.push({ id: a.key, name: a.key });
        // }
      });
    // });
  }

  getExchanges(exchange) {
    this.exchanges &#x3D; [];
    this.fluxService.getExchanges().subscribe(flux &#x3D;&gt; {
      this.exchangesRef &#x3D; flux;
      exchange.forEach(a &#x3D;&gt; {
        if (a.key !&#x3D;&#x3D; &#x27;&#x27; &amp;&amp; this.exchangesRef.find(x &#x3D;&gt; x.id &#x3D;&#x3D;&#x3D; a.key)) {
          this.exchanges.push({ id: a.key, name: this.exchangesRef.find(x &#x3D;&gt; x.id &#x3D;&#x3D;&#x3D; a.key).name });
        }
      });
    });
  }

  getExchangesBis(exchange, exchangeLong) {
    this.exchanges &#x3D; [];
    exchangeLong.forEach((a, i) &#x3D;&gt; {
      // let key &#x3D; a.key.replace(/[&#x27;&quot;]+/g, &#x27;&#x27;);
      // let keyLong &#x3D; exchangeLong[i].key.replace(/[&#x27;&quot;]+/g, &#x27;&#x27;);
      let key &#x3D; a.key.split(&#x27;§&#x27;);
      // let exch &#x3D; this.searchExchangeName(key, this.catalogue[&#x27;catalogue&#x27;]);
      // if (a.key !&#x3D;&#x3D; &#x27;&#x27; &amp;&amp; exch &amp;&amp; exch.desc &#x3D;&#x3D;&#x3D; key) {
      //   this.exchanges.push({ id: key, name: exch.name });
      // }
      this.exchanges.push({ id: key[0].replace(&#x27;[&#x27;,&#x27;&#x27;).replace(&#x27;]&#x27;,&#x27;&#x27;), name: key[1].replace(&#x27;[&#x27;,&#x27;&#x27;).replace(&#x27;]&#x27;,&#x27;&#x27;) });
    });
  }
  getSearch() {
    if (this.tabsearch &#x3D;&#x3D;&#x3D; &#x27;instrument&#x27;) {
      this.reqSearch.index &#x3D; environment.elastic.instrument.index;
      this.reqSearch.type &#x3D; environment.elastic.instrument.type;
    }
    if (this.tabsearch &#x3D;&#x3D;&#x3D; &#x27;feed&#x27;) {
      this.reqSearch.index &#x3D; environment.elastic.feed.index;
      this.reqSearch.type &#x3D; environment.elastic.feed.type;
    }
    let fields &#x3D; [];
    let must &#x3D; [];
    this.reqSearch.aggs &#x3D; {};
    this.reqSearch.query.bool.must &#x3D; [];
    let should &#x3D; [];

    fields &#x3D; [
      &#x27;Code&#x27;,
      &#x27;ContractID&#x27;,
      &#x27;EID&#x27;,
      &#x27;ContractEID&#x27;,
      &#x27;AssetClass&#x27;,
      &#x27;ContractEID&#x27;,
      &#x27;Description&#x27;,
      &#x27;ContractDescription&#x27;,
      &#x27;Symbol&#x27;,
      &#x27;ContractSymbol&#x27;,
      &#x27;ExchangeName&#x27;,
      &#x27;ContractExchange&#x27;,
      &#x27;ISIN&#x27;,
      &#x27;ContractISIN&#x27;,
      &#x27;AvailabilityStart&#x27;,
      &#x27;AvailabilityEnd&#x27;,
      &#x27;Availability&#x27;,
      &#x27;ContractAvailability&#x27;,
      &#x27;ContractAssetClass&#x27;,
      &#x27;ADTV&#x27;,
      &#x27;MICs&#x27;,
      &#x27;ContractADTV&#x27;
    ];

    if (this.all !&#x3D;&#x3D; &#x27;&#x27;) {
      // this.all &#x3D; this.all.replace(/\s/g,&#x27;&#x27;);
      let alltemp &#x3D; this.all.trim().split(&quot; &quot;);
      let allreq &#x3D; &#x27;&#x27;;
      alltemp.forEach(al&#x3D;&gt;{
        allreq +&#x3D; &#x27; +&quot;&#x27; + al + &#x27;&quot;&#x27;;
      })
      let shouldall &#x3D; [];

      if (this.symbol &#x3D;&#x3D;&#x3D; &#x27;&#x27;) {
        shouldall.push({
          &#x27;bool&#x27;: {
            &quot;should&quot;: [
              {
                &quot;query_string&quot;: {
                  &quot;default_field&quot;: &quot;Symbol&quot;,
                  &quot;query&quot;: allreq
                }
              },
              // {
              //   &#x27;wildcard&#x27;: {
              //     &#x27;Symbol&#x27;: {
              //       &#x27;value&#x27;: allreq + &#x27;*&#x27;
              //     }
              //   }
              // },
              {
                &quot;query_string&quot;: {
                  &quot;default_field&quot;: &quot;ContractSymbol&quot;,
                  &quot;query&quot;: allreq
                }
              }
              // {
              //   &#x27;wildcard&#x27;: {
              //     &#x27;ContractSymbol&#x27;: {
              //       &#x27;value&#x27;: allreq + &#x27;*&#x27;
              //     }
              //   }
              // }
            ]
          }
        });
      }
      shouldall.push({
        &#x27;bool&#x27;: {
          &quot;should&quot;: [
            {
              &quot;query_string&quot;: {
                &quot;default_field&quot;: &quot;Description&quot;,
                &quot;query&quot;: allreq
              }
              // &#x27;wildcard&#x27;: {
              //   &#x27;Description&#x27;: {
              //     &#x27;value&#x27;: &#x27;*&#x27; + allreq.toLowerCase() + &#x27;*&#x27;
              //   }
            // }
            },
            {
              &quot;query_string&quot;: {
                &quot;default_field&quot;: &quot;ContractDescription&quot;,
                &quot;query&quot;: allreq
              }
              // &#x27;wildcard&#x27;: {
              //   &#x27;ContractDescription&#x27;: {
              //     &#x27;value&#x27;: &#x27;*&#x27; + allreq.toLowerCase() + &#x27;*&#x27;
              //   }
              // }
            }
          ]
        }
      });
      shouldall.push({
        &quot;query_string&quot;: {
          &quot;default_field&quot;: &quot;LocalCodeStr&quot;,
          &quot;query&quot;: allreq
        }
        // &#x27;wildcard&#x27;: {
        //   &#x27;LocalCodeStr&#x27;: {
        //     &#x27;value&#x27;: &#x27;*&#x27; + allreq + &#x27;*&#x27;
        //   }
        // }
      });
      this.reqSearch.query.bool.must.push({
        &#x27;bool&#x27;: {
          &#x27;should&#x27;: shouldall
        }
      });
    }
    if (this.symbol !&#x3D;&#x3D; &#x27;&#x27;) {
      // this.symbol &#x3D; this.symbol.replace(/\s/g,&#x27;&#x27;);
      this.symbol &#x3D; this.symbol.trim();
      this.reqSearch.query.bool.must.push({
        &#x27;bool&#x27;: {
          &quot;should&quot;: [
            {
              &#x27;wildcard&#x27;: {
                &#x27;Symbol&#x27;: {
                  &#x27;value&#x27;: this.symbol.toUpperCase() + &#x27;*&#x27;
                }
              }
            },
            {
              &#x27;wildcard&#x27;: {
                &#x27;ContractSymbol&#x27;: {
                  &#x27;value&#x27;: this.symbol.toUpperCase() + &#x27;*&#x27;
                }
              }
            }
          ]
        }
      });
    }
    if (this.isin !&#x3D;&#x3D; &#x27;&#x27;) {
      // this.isin &#x3D; this.isin.replace(/\s/g,&#x27;&#x27;);
      this.isin &#x3D; this.isin.trim();
      this.reqSearch.query.bool.must.push({
        &#x27;wildcard&#x27;: {
          &#x27;ISIN&#x27;: {
            &#x27;value&#x27;: this.isin.toUpperCase() + &#x27;*&#x27;
          }
        }
      });
    }
    if (this.mics !&#x3D;&#x3D; &#x27;&#x27;) {
      // this.mics &#x3D; this.mics.replace(/\s/g,&#x27;&#x27;);
      this.mics &#x3D; this.mics.trim();
      this.reqSearch.query.bool.must.push({
        &#x27;wildcard&#x27;: {
          &#x27;MICs&#x27;: {
            &#x27;value&#x27;: this.mics.toUpperCase() + &#x27;*&#x27;
          }
        }
      });
    }

    if (this.assetsSearch.length &gt; 0) {
      this.reqSearch.query.bool.must.push({
        &#x27;bool&#x27;: {
          &quot;should&quot;: [
            { &#x27;terms&#x27;: { &#x27;AssetClass&#x27;: this.assetsSearch } },
            { &#x27;terms&#x27;: { &#x27;ContractAssetClass&#x27;: this.assetsSearch } }
          ]
        }
      });
    }
    if (this.exchangesSearch.length &gt; 0) {
      this.reqSearch.query.bool.must.push({
        &quot;bool&quot;: {
          &quot;should&quot;: [
            { &#x27;terms&#x27;: { &#x27;ExchangeName&#x27;: this.exchangesSearch } },
            { &#x27;terms&#x27;: { &#x27;ContractExchange&#x27;: this.exchangesSearch } },
            { &#x27;terms&#x27;: { &#x27;ExchangeName&#x27;: this.exchangesSearch } }
          ]
        }
      });
    }
    this.reqSearch.query.bool.must.push({
      &quot;bool&quot;: {
        &quot;should&quot;: [
          { &#x27;terms&#x27;: { &#x27;EID&#x27;: this.catalogue[&#x27;tabEid&#x27;] } },
          { &quot;terms&quot;: { &quot;ContractEID&quot;: this.catalogue[&#x27;tabEid&#x27;] }
          }
        ]
      }
    });

    this.reqSearch.fields &#x3D; fields;
    this.out &#x3D; this.reqSearch;
    if(this.all !&#x3D;&#x3D;&#x27;&#x27; || this.symbol !&#x3D;&#x3D; &#x27;&#x27; || this.isin !&#x3D;&#x3D; &#x27;&#x27; || this.mics !&#x3D;&#x3D; &#x27;&#x27; || this.exchangesSearch.length &gt; 0 || this.assetsSearch.length &gt; 0){
      this.elasticService.getSearch(this.reqSearch).subscribe(resp &#x3D;&gt; {
        this.hits &#x3D; [];
        resp.hits.hits.forEach(hit &#x3D;&gt; {
          hit[&#x27;selected&#x27;] &#x3D; false;
          this.hits.push(hit);
        });
        this.total &#x3D; resp.hits.total;
        this.pagesize &#x3D; resp.hits.total - parseInt(this.nbperpage, 10);
        if (this.pagesize &lt;&#x3D; 0) {
          this.from &#x3D; 1;
          this.to &#x3D; this.total;
        }
      });
    }
  };

  reset() {
    this.nbperpage &#x3D; &#x27;10&#x27;;
    this.pagesize &#x3D; 0;
    this.page &#x3D; 0;
    this.total &#x3D; 0;
    this.from &#x3D; 0;
    this.to &#x3D; 0;
    this.reqSearch &#x3D; { fields: [], query: { bool: { must: [], should: [], must_not: [] } }, aggs: {}, from: 0, size: parseInt(this.nbperpage, 10), index: [], type: [] };
    this.all &#x3D; &#x27;&#x27;;
    this.symbol &#x3D; &#x27;&#x27;;
    this.isin &#x3D; &#x27;&#x27;;
    this.mics &#x3D; &#x27;&#x27;;
    this.exchange &#x3D; &#x27;&#x27;;
    this.nassc &#x3D; &#x27;&#x27;;
    this.assetsSearch &#x3D; [];
    this.exchangesSearch &#x3D; [];
    this.hits &#x3D; [];
    this.options &#x3D; [];
    this.addCart &#x3D; {
      onetime: 0,
      complete: 0,
      onetimeFrom: &#x27;&#x27;,
      onetimeTo: &#x27;&#x27;,
      subscription: 0,
      products: []
    };
    // this.btnFocus();
  };

  addnbperpage(e) {
    this.page &#x3D; 0;
    this.nbperpage &#x3D; e;
    this.to &#x3D; parseInt(this.nbperpage, 10);
    this.reqSearch.size &#x3D; parseInt(this.nbperpage, 10);
    this.getSearch();
  };

  updPagination() {
    this.pageTo &#x3D; parseInt(this.nbperpage, 10);
    this.from &#x3D; ((this.page - 1) * this.pageTo) + 1;
    this.reqSearch.from &#x3D; (this.page - 1) * this.pageTo;
    if ((this.reqSearch.from + this.pageTo) &gt; this.total) {
      this.to &#x3D; this.total
    } else {
      this.to &#x3D; this.page * this.pageTo;
    }
    if (this.btnSearch) {
      this.getSearch();
    } else {
      this.btnSearch &#x3D; true;
    }
  };

  addAsset(e) {
    this.assetsSearch.push(e);
    this.inputEl.nativeElement.focus();
  };

  addEchange(e) {
    this.exchangesSearch.push(e);
    this.inputEl.nativeElement.focus();
  };
  btnFocus(){
    this.inputEl.nativeElement.focus();
  }
  getShowEntries() {
    this.nbPerPage &#x3D; [
      { id: &#x27;5&#x27;, name: &#x27;5&#x27; },
      { id: &#x27;10&#x27;, name: &#x27;10&#x27; },
      { id: &#x27;25&#x27;, name: &#x27;25&#x27; },
      { id: &#x27;50&#x27;, name: &#x27;50&#x27; },
      { id: &#x27;100&#x27;, name: &#x27;100&#x27; }
    ];
  };

  delEx(e) {
    this.exchangesSearch.splice(this.exchangesSearch.indexOf(e), 1);
    this.inputEl.nativeElement.focus();
  }
  delAs(a) {
    this.assetsSearch.splice(this.assetsSearch.indexOf(a), 1);
    this.inputEl.nativeElement.focus();
  }
  datePeriod() {
    this.addCart.complete &#x3D; 0;
  }
  dateComplete() {
    this.addCart.complete &#x3D; 1;
    this.addCart.onetimeFrom &#x3D; &#x27;&#x27;;
    this.addCart.onetimeTo &#x3D; &#x27;&#x27;;
    this.addCart.products.forEach((p, i) &#x3D;&gt; {
      this.addCart.products[i].begin_date_select &#x3D; this.addCart.products[i].begin_date;
      this.addCart.products[i].end_date_select &#x3D; this.addCart.products[i].end_date;
    });
  }
  dateChangeBegin(date) {
    this.addCart.complete &#x3D; 0;
    if (date) {
      let selectdate &#x3D; new Date(date.year + &#x27;-&#x27; + date.month + &#x27;-&#x27; + date.day);
      this.addCart.products.forEach((p, i) &#x3D;&gt; {
        let bd &#x3D; new Date(p.begin_date);
        if (bd &lt;&#x3D; selectdate) {
          this.addCart.products[i].begin_date_select &#x3D; date.year + &#x27;-&#x27; + date.month + &#x27;-&#x27; + date.day;
        }
      });
    }
  }
  dateChangeEnd(date) {
    this.addCart.complete &#x3D; 0;
    if (date) {
      let selectdate &#x3D; new Date(date.year + &#x27;-&#x27; + date.month + &#x27;-&#x27; + date.day);
      this.addCart.products.forEach((p, i) &#x3D;&gt; {
        let ed &#x3D; new Date(p.end_date);
        if (ed &gt;&#x3D; selectdate) {
          this.addCart.products[i].end_date_select &#x3D; date.year + &#x27;-&#x27; + date.month + &#x27;-&#x27; + date.day;
        }
      });
    }
  }


  dateChangeFrom() {
    let convOneTimeFrom &#x3D; new Date();
    let convOneTimeTo &#x3D; new Date();
    let convOneTimeFromMin &#x3D; new Date();

    convOneTimeFrom &#x3D; new Date(this.onetimeFrom.year, this.onetimeFrom.month - 1, this.onetimeFrom.day);
    convOneTimeFromMin &#x3D; new Date(this.minDate.year, this.minDate.month - 1, this.minDate.day);
    convOneTimeTo &#x3D; new Date(this.onetimeTo.year, this.onetimeTo.month - 1, this.onetimeTo.day);

    if(convOneTimeFrom &gt; convOneTimeTo) {
      this.onetimeFrom &#x3D; { year: convOneTimeTo.getFullYear(), month: convOneTimeTo.getMonth() + 1, day: convOneTimeTo.getDate() };
    }
    if(convOneTimeFrom &lt; convOneTimeFromMin) {
      this.onetimeFrom &#x3D; { year: convOneTimeFromMin.getFullYear(), month: convOneTimeFromMin.getMonth() + 1, day: convOneTimeFromMin.getDate() };
    }
    this.addCart.onetimeFrom &#x3D; this.onetimeFrom.year + &#x27;-&#x27; + this.onetimeFrom.month  + &#x27;-&#x27; + this.onetimeFrom.day;
    this.dateChangeBegin(this.onetimeFrom);
  }
  dateChangeTo() {
    let convOneTimeFrom &#x3D; new Date();
    let convOneTimeTo &#x3D; new Date();
    let convOneTimeToMax &#x3D; new Date();

    convOneTimeFrom &#x3D; new Date(this.onetimeFrom.year, this.onetimeFrom.month - 1, this.onetimeFrom.day);
    convOneTimeTo &#x3D; new Date(this.onetimeTo.year, this.onetimeTo.month - 1, this.onetimeTo.day);
    convOneTimeToMax &#x3D; new Date(this.maxDate.year, this.maxDate.month - 1, this.maxDate.day);

    if(convOneTimeFrom &gt; convOneTimeTo) {
      this.onetimeTo &#x3D; { year: convOneTimeFrom.getFullYear(), month: convOneTimeFrom.getMonth() + 1, day: convOneTimeFrom.getDate() };
    }
    if(convOneTimeTo &gt; convOneTimeToMax) {
      this.onetimeTo &#x3D; { year: convOneTimeToMax.getFullYear(), month: convOneTimeToMax.getMonth() + 1, day: convOneTimeToMax.getDate() };
    }
    this.addCart.onetimeTo &#x3D; new Date (this.onetimeTo.year + &#x27;-&#x27; + this.onetimeTo.month  + &#x27;-&#x27; + this.onetimeTo.day).toJSON();
    this.dateChangeEnd(this.onetimeTo);
  }

  updtCheck(option, event) {
    if (event.target.checked) {
      let product &#x3D; new Product();
      product.index &#x3D; option._index;
      product.idx &#x3D; option._id;
      this.fluxService.infoProduct(option._source.EID).subscribe(eid&#x3D;&gt;{
        product.historical_data &#x3D; eid.historical_data;
        product.contractid &#x3D; &#x27;&#x27;;
        if (option._index &#x3D;&#x3D;&#x3D; environment.elastic.feed.productdb) { // FEED
          let av0 &#x3D; new Date(option._source.AvailabilityStart);
          let av1 &#x3D; new Date(option._source.AvailabilityEnd);
  
          if (this.addCart.products.length &#x3D;&#x3D;&#x3D; 0) {
            this.minDate &#x3D; { year: av0.getFullYear(), month: (av0.getMonth()+1), day: av0.getDate() };
            this.config.minDate &#x3D; this.minDate;
            this.maxDate &#x3D; { year: av1.getFullYear(), month: (av1.getMonth()+1), day: av1.getDate() };
            this.config.maxDate &#x3D; this.maxDate;
          } else {
            if (av0 &lt; new Date(this.minDate.year + &#x27;-&#x27; + this.minDate.month + &#x27;-&#x27; + this.minDate.day)) {
              this.minDate &#x3D; { year: av0.getFullYear(), month: (av0.getMonth()+1), day: av0.getDate() };
              this.config.minDate &#x3D; this.minDate;
            }
            if (av1 &gt; new Date(this.maxDate.year + &#x27;-&#x27; + this.maxDate.month + &#x27;-&#x27; + this.maxDate.day)) {
              this.maxDate &#x3D; { year: av1.getFullYear(), month: (av1.getMonth()+1), day: av1.getDate() };
              this.config.maxDate &#x3D; this.maxDate;
            }
          }
          product.contractid &#x3D; &#x27;&#x27;;
          product.qhid &#x3D; &#x27;&#x27;;
          product.description &#x3D; this.catalogue[&#x27;catalogue&#x27;][ this.catalogue[&#x27;tabEid&#x27;].indexOf(option._source.EID.toString()) ].name;
          product.pricingtier &#x3D; 1;
          product.eid &#x3D; option._source.EID;
          product.quotation_level &#x3D; this.dataset.dataset;
          product.exchange &#x3D; option._source.ExchangeName;
          product.assetClass &#x3D; &#x27;&#x27;;
          product.symbol &#x3D; &#x27;&#x27;;
          product.begin_date &#x3D; av0.toJSON();
          product.begin_date_select &#x3D; av0.toJSON();
          product.end_date &#x3D; av1.toJSON();
          product.end_date_select &#x3D; av1.toJSON();
          product.id_cmd &#x3D; &#x27;&#x27;;
        }
        if (option._index &#x3D;&#x3D;&#x3D; environment.elastic.instrument.nonderivatives) { // Instrument non-deriv
          let av0 &#x3D; new Date(option._source.AvailabilityStart);
          let av1 &#x3D; new Date(option._source.AvailabilityEnd);
          
          if (this.addCart.products.length &#x3D;&#x3D;&#x3D; 0) {
            this.minDate &#x3D; { year: av0.getFullYear(), month: (av0.getMonth()+1), day: av0.getDate() };
            this.config.minDate &#x3D; this.minDate;
            this.maxDate &#x3D; { year: av1.getFullYear(), month: (av1.getMonth()+1), day: av1.getDate() };
            this.config.maxDate &#x3D; this.maxDate;
          } else {
            if (av0 &lt; new Date(this.minDate.year + &#x27;-&#x27; + this.minDate.month + &#x27;-&#x27; + this.minDate.day)) {
              this.minDate &#x3D; { year: av0.getFullYear(), month: (av0.getMonth()+1), day: av0.getDate() };
              this.config.minDate &#x3D; this.minDate;
            }
            if (av1 &gt; new Date(this.maxDate.year + &#x27;-&#x27; + this.maxDate.month + &#x27;-&#x27; + this.maxDate.day)) {
              this.maxDate &#x3D; { year: av1.getFullYear(), month: (av1.getMonth()+1), day: av1.getDate() };
              this.config.maxDate &#x3D; this.maxDate;
            }
          }
          product.adtv &#x3D; option._source.ADTV;
          if (this.tabsearch &#x3D;&#x3D;&#x3D; &#x27;instrument&#x27;) {
            product.pricingtier &#x3D; this.verifPricingTier(option._index, option._source.ADTV);
          }
          if (this.tabsearch &#x3D;&#x3D;&#x3D; &#x27;feed&#x27;) {
            product.pricingtier &#x3D; option._source.ContractPricingTier;//Voir QuantFlow
          }
          product.contractid &#x3D; option._source.ContractID;
          // product.pricingtier &#x3D; option._source.PricingTier;
          product.qhid &#x3D; option._source.Code;
          product.eid &#x3D; option._source.EID;
          product.description &#x3D; option._source.Description;
          product.quotation_level &#x3D; this.dataset.dataset;
          product.exchange &#x3D; option._source.ExchangeName;
          product.assetClass &#x3D; option._source.AssetClass;
          product.symbol &#x3D; option._source.Symbol;
          product.begin_date &#x3D; av0.toJSON();
          product.begin_date_select &#x3D; av0.toJSON();
          product.end_date &#x3D; av1.toJSON();
          product.end_date_select &#x3D; av1.toJSON();
          product.id_cmd &#x3D; &#x27;&#x27;;
        }
        if (option._index &#x3D;&#x3D;&#x3D; environment.elastic.instrument.derivatives) { // Instrument deriv
          let av0 &#x3D; new Date(option._source.AvailabilityStart);
          let av1 &#x3D; new Date(option._source.AvailabilityEnd);
  
          if (this.addCart.products.length &#x3D;&#x3D;&#x3D; 0) {
            this.minDate &#x3D; { year: av0.getFullYear(), month: (av0.getMonth()+1), day: av0.getDate() };
            this.config.minDate &#x3D; this.minDate;
            this.maxDate &#x3D; { year: av1.getFullYear(), month: (av1.getMonth()+1), day: av1.getDate() };
            this.config.maxDate &#x3D; this.maxDate;
          } else {
            if (av0 &lt; new Date(this.minDate.year + &#x27;-&#x27; + this.minDate.month + &#x27;-&#x27; + this.minDate.day)) {
              this.minDate &#x3D; { year: av0.getFullYear(), month: (av0.getMonth()+1), day: av0.getDate() };
              this.config.minDate &#x3D; this.minDate;
            }
            if (av1 &gt; new Date(this.maxDate.year + &#x27;-&#x27; + this.maxDate.month + &#x27;-&#x27; + this.maxDate.day)) {
              this.maxDate &#x3D; { year: av1.getFullYear(), month: (av1.getMonth()+1), day: av1.getDate() };
              this.config.maxDate &#x3D; this.maxDate;
            }
          }
          product.contractid &#x3D; option._source.ContractID;
          // product.adtv &#x3D; option._source.ContractADTV;
          product.adtv &#x3D; option._source.ADTV;
          if (this.tabsearch &#x3D;&#x3D;&#x3D; &#x27;instrument&#x27;) {
            // product.pricingtier &#x3D; this.verifPricingTier(option._source.ContractADTV);
            product.pricingtier &#x3D; this.verifPricingTier(option._index, option._source.ADTV);
          }
          if (this.tabsearch &#x3D;&#x3D;&#x3D; &#x27;feed&#x27;) {
            product.pricingtier &#x3D; option._source.ContractPricingTier;//Voir QuantFlow
          }
          // product.pricingtier &#x3D; option._source.ContractPricingTier;
          // product.qhid &#x3D; option._source.QHID;
          product.description &#x3D; &#x27;&#x27;;
          product.qhid &#x3D; &#x27;&#x27;;
          product.mics &#x3D; option._source.MICs;
          // product.eid &#x3D; option._source.ContractEID;
          product.eid &#x3D; option._source.EID;
          product.quotation_level &#x3D; this.dataset.dataset;
          // product.exchange &#x3D; option._source.ContractExchange;
          product.exchange &#x3D; option._source.ExchangeName;
          product.assetClass &#x3D; option._source.AssetClass;
          // product.symbol &#x3D; option._source.ContractSymbol;
          product.symbol &#x3D; option._source.Symbol;
          product.begin_date &#x3D; av0.toJSON();
          product.end_date &#x3D; av1.toJSON();
          product.begin_date_select &#x3D; av0.toJSON();
          product.end_date_select &#x3D; av1.toJSON();
          product.id_cmd &#x3D; &#x27;&#x27;;
        }
        product.status &#x3D; &#x27;validated&#x27;;
        this.addCart.products.push(product);
      });
    } else {
      this.addCart.products.splice(this.addCart.products.indexOf(option), 2);
    }
  }
  
  getAvailability(db, ed) {
    this.avaibility &#x3D; true;

    let dd &#x3D; new Date(db);
    let df &#x3D; new Date(ed);
    let toFro &#x3D; this.calendar.getToday();
    toFro.day &#x3D; dd.getDate();
    toFro.month &#x3D; dd.getMonth() + 1;
    toFro.year &#x3D; dd.getFullYear();
    let toDat &#x3D; this.calendar.getToday();
    toDat.day &#x3D; df.getDate();
    toDat.month &#x3D; df.getMonth() + 1;
    toDat.year &#x3D; df.getFullYear();

    this.fromDate &#x3D; this.calendar.getPrev(toFro, &#x27;d&#x27;, 0);
    this.toDate &#x3D; this.calendar.getNext(toDat, &#x27;d&#x27;, 0);
  }

  close() {
    this.avaibility &#x3D; false;
  }

  product(prd, onetime, subscription) {
    let prod &#x3D; {};
    let diff &#x3D; this.dateDiff(new Date(prd.begin_date_select), new Date(prd.end_date_select));
    prod[&#x27;idx&#x27;] &#x3D; prd.idx;
    prod[&#x27;index&#x27;] &#x3D; prd.index;
    prod[&#x27;contractid&#x27;] &#x3D; prd.contractid;
    prod[&#x27;description&#x27;] &#x3D; prd.description;
    prod[&#x27;qhid&#x27;] &#x3D; prd.qhid;
    prod[&#x27;eid&#x27;] &#x3D; prd.eid;
    prod[&#x27;quotation_level&#x27;] &#x3D; prd.quotation_level;
    prod[&#x27;exchange&#x27;] &#x3D; prd.exchange;
    prod[&#x27;assetClass&#x27;] &#x3D; prd.assetClass;
    prod[&#x27;mics&#x27;] &#x3D; prd.mics;
    prod[&#x27;symbol&#x27;] &#x3D; prd.symbol;
    prod[&#x27;begin_date&#x27;] &#x3D; prd.begin_date;
    prod[&#x27;begin_date_select&#x27;] &#x3D; prd.begin_date_select;
    prod[&#x27;end_date&#x27;] &#x3D; prd.end_date;
    prod[&#x27;end_date_select&#x27;] &#x3D; prd.end_date_select;
    prod[&#x27;id_cmd&#x27;] &#x3D; prd.id_cmd;
    prod[&#x27;historical_data&#x27;] &#x3D; prd.historical_data;
    if (prd.historical_data.backfill_fee &amp;&amp; prd.historical_data.backfill_applyfee &amp;&amp; onetime &#x3D;&#x3D;&#x3D; 1 &amp;&amp; !prd.historical_data.direct_billing) {
    // if (prd.historical_data.backfill_fee &amp;&amp; prd.historical_data.backfill_applyfee &amp;&amp; onetime &#x3D;&#x3D;&#x3D; 1) {
      prod[&#x27;backfill_fee&#x27;] &#x3D; prd.historical_data.backfill_fee;
    } else {
      prod[&#x27;backfill_fee&#x27;] &#x3D; 0;
    }
    if (prd.historical_data.ongoing_fee &amp;&amp; prd.historical_data.ongoing_applyfee &amp;&amp; subscription &#x3D;&#x3D;&#x3D; 1 &amp;&amp; !prd.historical_data.direct_billing) {
    // if (prd.historical_data.ongoing_fee &amp;&amp; prd.historical_data.ongoing_applyfee &amp;&amp; subscription &#x3D;&#x3D;&#x3D; 1) {
      prod[&#x27;ongoing_fee&#x27;] &#x3D; prd.historical_data.ongoing_fee;
    } else {
      prod[&#x27;ongoing_fee&#x27;] &#x3D; 0;
    }
    prod[&#x27;status&#x27;] &#x3D; prd.status;
    prod[&#x27;price&#x27;] &#x3D; prd.price;
    if (onetime &#x3D;&#x3D;&#x3D; 1) {
      if(diff.day &lt; 20){ diff.day &#x3D; 19; }
      prod[&#x27;ht&#x27;] &#x3D; (diff.day + 1) * prd.price;
    } else if(subscription &#x3D;&#x3D;&#x3D; 1){
      prod[&#x27;ht&#x27;] &#x3D; this.periodSubscription * parseInt(prd.price);
    }
    prod[&#x27;pricingTier&#x27;] &#x3D; prd.pricingtier;
    prod[&#x27;onetime&#x27;] &#x3D; onetime;
    prod[&#x27;subscription&#x27;] &#x3D; subscription;
    if (subscription &#x3D;&#x3D;&#x3D; 1) {
      prod[&#x27;period&#x27;] &#x3D; this.periodSubscription;
    } else {
      prod[&#x27;period&#x27;] &#x3D; diff.day + 1;
    }
    return prod;
  }

  save() {
    let caddy &#x3D; [];
    let prod &#x3D; {};
    if (this.addCart.onetime &#x3D;&#x3D;&#x3D; 1) {
      this.addCart.products.forEach((prd) &#x3D;&gt; {
        if(this.tabsearch &#x3D;&#x3D;&#x3D; &#x27;instrument&#x27;) {
          prd.price &#x3D; this.tabPrice.instrument.day[prd.pricingtier][this.ds];
        }
        if(this.tabsearch &#x3D;&#x3D;&#x3D; &#x27;feed&#x27;) {
          prd.price &#x3D; this.tabPrice.feed.day[prd.pricingtier][this.ds];
        }
        prod &#x3D; this.product(prd, this.addCart.onetime, 0);
        if(!this.verifExist(prod)) { caddy.push(prod); }
      });
    }
    if (this.addCart.subscription &#x3D;&#x3D;&#x3D; 1) {
      this.addCart.products.forEach((p) &#x3D;&gt; {
        if(this.tabsearch &#x3D;&#x3D;&#x3D; &#x27;instrument&#x27;) {
          p.price &#x3D; this.tabPrice.instrument.month[p.pricingtier][this.ds];
        }
        if(this.tabsearch &#x3D;&#x3D;&#x3D; &#x27;feed&#x27;) {
          p.price &#x3D; this.tabPrice.feed.month[p.pricingtier][this.ds];
        }
        prod &#x3D; this.product(p, 0, this.addCart.subscription);
        if(!this.verifExist(prod)) { 
          prod[&#x27;begin_date_select&#x27;] &#x3D; &#x27;&#x27;;
          prod[&#x27;end_date_select&#x27;] &#x3D; &#x27;&#x27;;
          caddy.push(prod);
        }
      });
    }
    this.userService.getCompte(this.user[&#x27;_id&#x27;]).subscribe((u) &#x3D;&gt; {
      this.orderService.getIdCmd(this.user[&#x27;_id&#x27;]).subscribe((idcmd) &#x3D;&gt; {
        sessionStorage.setItem(&#x27;cart&#x27;, JSON.stringify(idcmd));
        this.orderService.updateOrder({ state: &quot;CART&quot;, idcmd, u, cart: caddy }).subscribe((res) &#x3D;&gt; {
          this.resetSelect();
        });
      })
    })
  }

  verifExist(p) {
    let resp &#x3D; false;
    if (this.caddies.length &gt; 0) {
      this.caddies.forEach(cp&#x3D;&gt;{
        if( p.quotation_level &#x3D;&#x3D;&#x3D; cp[&#x27;quotation_level&#x27;] &amp;&amp;
            p.idx &#x3D;&#x3D;&#x3D; cp[&#x27;id&#x27;]  &amp;&amp;
            p.onetime &#x3D;&#x3D;&#x3D; cp[&#x27;onetime&#x27;] &amp;&amp;
            p.subscription &#x3D;&#x3D;&#x3D; cp[&#x27;subscription&#x27;]
        ) {
          if(p.subscription &#x3D;&#x3D;&#x3D; 1) {
            resp &#x3D; true;
          } else {
            if (p.onetime &#x3D;&#x3D;&#x3D; 1 &amp;&amp; p.begin_date_select &#x3D;&#x3D;&#x3D; cp[&#x27;begin_date_select&#x27;] &amp;&amp; p.end_date_select &#x3D;&#x3D;&#x3D; cp[&#x27;end_date_select&#x27;] ) {
              resp &#x3D; true;
            }
          }
        }
      });
    }
    return resp;
  }

  addCaddies() {
    let c &#x3D; [];
    if (c &#x3D; JSON.parse(sessionStorage.getItem(&#x27;cart&#x27;))) {
      this.addCart.products.forEach((prd) &#x3D;&gt; {
        prd.onetime &#x3D; this.addCart.onetime;
        prd.subscription &#x3D; this.addCart.subscription;
        c.push(prd);
      });
      sessionStorage.setItem(&#x27;cart&#x27;, JSON.stringify(c));
    } else {
      c &#x3D; [];
      this.addCart.products.forEach((prd) &#x3D;&gt; {
        prd.onetime &#x3D; this.addCart.onetime;
        prd.subscription &#x3D; this.addCart.subscription;
        c.push(prd);
      });
      sessionStorage.setItem(&#x27;cart&#x27;, JSON.stringify(c));
    }
  }

  isHovered &#x3D; date &#x3D;&gt; this.fromDate &amp;&amp; !this.toDate &amp;&amp; this.hoveredDate &amp;&amp; after(date, this.fromDate) &amp;&amp; before(date, this.hoveredDate);
  isInside &#x3D; date &#x3D;&gt; after(date, this.fromDate) &amp;&amp; before(date, this.toDate);
  isFrom &#x3D; date &#x3D;&gt; equals(date, this.fromDate);
  isTo &#x3D; date &#x3D;&gt; equals(date, this.toDate);

  onDateChange(date: NgbDateStruct) {
    if (!this.fromDate &amp;&amp; !this.toDate) {
      this.fromDate &#x3D; date;
    } else if (this.fromDate &amp;&amp; !this.toDate &amp;&amp; after(date, this.fromDate)) {
      this.toDate &#x3D; date;
    } else {
      this.toDate &#x3D; null;
      this.fromDate &#x3D; date;
    }
  }

  open(content) {
    this.addCart.onetimeFrom &#x3D; this.minDate.year + &#x27;-&#x27; + this.minDate.month  + &#x27;-&#x27; + this.minDate.day;
    this.addCart.onetimeTo &#x3D; this.maxDate.year + &#x27;-&#x27; + this.maxDate.month  + &#x27;-&#x27; + this.maxDate.day;
    if(!this.onetimeFrom) {
      this.onetimeFrom &#x3D; this.minDate;
    }
    if(!this.onetimeTo) {
      this.onetimeTo &#x3D; this.maxDate;
    }
    this.modalService.open(content).result.then((result) &#x3D;&gt; {
      this.closeResult &#x3D; &#x60;Closed with: ${result}&#x60;;
    }, (reason) &#x3D;&gt; {
      this.closeResult &#x3D; &#x60;Dismissed ${this.getDismissReason(reason)}&#x60;;
    });
  }
  private getDismissReason(reason: any): string {
    if (reason &#x3D;&#x3D;&#x3D; ModalDismissReasons.ESC) {
      return &#x27;by pressing ESC&#x27;;
    } else if (reason &#x3D;&#x3D;&#x3D; ModalDismissReasons.BACKDROP_CLICK) {
      return &#x27;by clicking on a backdrop&#x27;;
    } else {
      return &#x60;with: ${reason}&#x60;;
    }
  }

  public beforeChange($event: NgbTabChangeEvent) {
    this.tabsearch &#x3D; $event.nextId;
    this.getPricingTier();
    this.getAssetExchange();
  };

  onetimeCheckbox(element: HTMLInputElement): void {
    if (element.checked) {
      this.addCart.onetime &#x3D; 1;
    } else {
      this.addCart.onetime &#x3D; 0;
    }
  }

  subscriptionCheckbox(element: HTMLInputElement): void {
    if (element.checked) {
      this.addCart.subscription &#x3D; 1;

    } else {
      this.addCart.subscription &#x3D; 0;
    }
  }
  isString(val) { return typeof val &#x3D;&#x3D;&#x3D; &#x27;string&#x27;; }
  isNumber(val) { return typeof val &#x3D;&#x3D;&#x3D; &#x27;number&#x27;; }

  dateDiff(date1, date2){
    let diff &#x3D; { sec: 0, min: 0, hour:0, day: 0 };
    let tmp &#x3D; date2 - date1;
    tmp &#x3D; Math.floor(tmp/1000);
    diff.sec &#x3D; tmp % 60;
    tmp &#x3D; Math.floor((tmp-diff.sec)/60);
    diff.min &#x3D; tmp % 60;
    tmp &#x3D; Math.floor((tmp-diff.min)/60);
    diff.hour &#x3D; tmp % 24;
    tmp &#x3D; Math.floor((tmp-diff.hour)/24);
    diff.day &#x3D; tmp;
    return diff;
  }

  dateNGB(d) {
    let dm &#x3D; this.calenda.getToday();
    let dsplit &#x3D; d.split(&#x27;-&#x27;);
    dm.year &#x3D; parseInt(dsplit[0]);
    dm.month &#x3D; parseInt(dsplit[1]);
    dm.day &#x3D; parseInt(dsplit[2]);
    return dm;
  }

  objectToArray(a) {
    let t &#x3D; [];
    for (let key in a) {
      t.push(a[key]);
    }
    return t;
  }
  
  searchDataset(nameKey, myArray){
    for (var i&#x3D;0; i &lt; myArray.length; i++) {
        if (myArray[i].id &#x3D;&#x3D;&#x3D; nameKey) {
            return myArray[i];
        }
    }
  }
  searchExchangeName(nameKey, myArray){
    for (var i&#x3D;0; i &lt; myArray.length; i++) {
        if (myArray[i].desc &#x3D;&#x3D;&#x3D; nameKey) {
            return myArray[i];
        }
    }
  }
  objectToArrayAss(a) {
    let t &#x3D; [];
    a.forEach(element &#x3D;&gt; {
      for (let key in element) {
        t[key] &#x3D; a[key];
      }
    });
  }
}
</code></pre>
    </div>
</div>







                   </div><div class="search-results">
    <div class="has-results">
        <h1 class="search-results-title"><span class='search-results-count'></span> result-matching "<span class='search-query'></span>"</h1>
        <ul class="search-results-list"></ul>
    </div>
    <div class="no-results">
        <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
    </div>
</div>
</div>
               <!-- END CONTENT -->
           </div>
       </div>

       <script>
            var COMPODOC_CURRENT_PAGE_DEPTH = 1;
            var COMPODOC_CURRENT_PAGE_CONTEXT = 'class';
            var COMPODOC_CURRENT_PAGE_URL = 'Product-1.html';
       </script>

       <script src="../js/libs/custom-elements.min.js"></script>
       <script src="../js/libs/lit-html.js"></script>
       <!-- Required to polyfill modern browsers as code is ES5 for IE... -->
       <script src="../js/libs/custom-elements-es5-adapter.js" charset="utf-8" defer></script>
       <script src="../js/menu-wc.js" defer></script>

       <script src="../js/libs/bootstrap-native.js"></script>

       <script src="../js/libs/es6-shim.min.js"></script>
       <script src="../js/libs/EventDispatcher.js"></script>
       <script src="../js/libs/promise.min.js"></script>
       <script src="../js/libs/zepto.min.js"></script>

       <script src="../js/compodoc.js"></script>

       <script src="../js/tabs.js"></script>
       <script src="../js/menu.js"></script>
       <script src="../js/libs/clipboard.min.js"></script>
       <script src="../js/libs/prism.js"></script>
       <script src="../js/sourceCode.js"></script>
          <script src="../js/search/search.js"></script>
          <script src="../js/search/lunr.min.js"></script>
          <script src="../js/search/search-lunr.js"></script>
          <script src="../js/search/search_index.js"></script>
       <script src="../js/lazy-load-graphs.js"></script>


    </body>
</html>
